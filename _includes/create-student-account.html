<div class="logged_out">
	<div class="section-header">Student Sign Up</div>
	<form id="create_student_account_form">
		<ul class="form-list">
			{% include form-line.html formName="create_student_account" inputID="name" inputType="text" placeholder="Name (visible to teammates)" %}
			{% include form-line.html formName="create_student_account" inputID="studentID" inputType="text" placeholder="UC Davis Student ID" %}
			{% include form-line.html formName="create_student_account" inputID="password" inputType="password" placeholder="Password" %}
			{% include form-line.html formName="create_student_account" inputID="confirm_password" inputType="password" placeholder="Confirm Password" %}
		</ul>
		{% include button.html function="processCreateStudentAccount" id="create_student_account" label="Sign Up" %}
	</form>
	{% include alert-message.html id="create_student_account" type="error" %}
</div>
<div class="logged_in">
	Already signed in.
</div>

<script>
	clearAlertPrinter("create_student_account");

	function processCreateStudentAccount() {
		if (studentCommands.getIsProcessing()) return;

		const formName = "create_student_account";

		const elements = document.getElementById(formName + "_form").elements;
		const accountID = parseInt(elements[formName + "_studentID"].value);
		const name = elements[formName + "_name"].value;
		const password = elements[formName + "_password"].value;
		const confirm = elements[formName + "_confirm_password"].value;
		const printer = getAlertPrinter(formName);

		if (!isString(name) || !isString(password) || !isString(confirm)) {
			printer("Invalid data type.");
			return;
		}

		if (isNaN(accountID)) {
			printer("Please enter a valid Student ID");
			return;
		}

		if (isNullOrEmpty(name) || isNullOrEmpty(password) || isNullOrEmpty(confirm)) {
			printer("All fields must be filled out!");
			return;
		}

		if (confirm !== password) {
			printer("Passwords do not match!");
			return;
		}

		const submitButton = $("#button_" + formName);
		submitButton.prop("disabled", true);
		printer("");

		const onComplete = function(msg) {
			submitButton.prop("disabled", false);
			printer(msg);
		}

		studentCommands.createAccount(accountID, name, password, getPageRedirector("/howtoplay"), onComplete);
	}
</script>
